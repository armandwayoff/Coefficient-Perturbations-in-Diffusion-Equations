import matplotlib as mpl
import numpy
import matplotlib.pyplot as plt
import numpy as np
from matplotlib.patches import Rectangle
from matplotlib.ticker import LogLocator

# mpl.use("pgf")


# Data
x = np.array([236, 239, 242, 243, 244, 246, 250])
y = np.array([0.495974, 0.876021, 0.498762, 4.76016e+08, 0.501225, 0.505584, 0.503821])
y2 = np.array([0.305502, 0.315596, 0.309824, 0.316576, 0.307187, 0.31545, 0.310365])
y3 = np.array([0.0429325, 0.0748221, 0.0434108, 8.88536e+07, 0.0432376, 0.0462146, 0.04242])


# List of keys
keys = [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 
        30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 
        40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 
        50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 
        60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 
        70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 
        80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 
        100, 101, 102, 103, 104, 105, 106, 107, 
        108, 109, 110, 111, 112, 113, 114, 115, 
        116, 117, 118, 119, 120, 121, 122, 123, 
        124, 125, 126, 127, 128, 129, 130, 131, 
        132, 133, 134, 135, 136, 137, 138, 139, 
        140, 141, 142, 143, 144, 145, 146, 147, 
        148, 149, 150, 151, 152, 153, 154, 155, 
        156, 157, 158, 159, 160, 161, 162, 163, 
        164, 165, 166, 167, 168, 169, 170, 171, 
        172, 173, 174, 175, 176, 177, 178, 179, 
        180, 181, 182, 183, 184, 185, 186, 187, 
        188, 189, 190, 191, 192, 193, 194, 195, 
        196, 197, 198, 199, 200, 201, 202, 203, 
        204, 205, 206, 207, 208, 209, 210, 211, 
        212, 213, 214, 215, 216, 217, 218, 219, 
        220, 221, 222, 223, 224, 225, 226, 227, 
        228, 229, 230, 231, 232, 233, 234, 235, 
        236, 237, 238, 239, 240, 241, 242, 243, 
        244, 245, 246, 247, 248, 249]

# List of values
values9 = [0.322852, 0.434041, 0.400771, 0.420442, 0.425349, 0.628037, 0.385078, 
          4.75672e+11, 0.402682, 0.643969, 0.434772, 0.704053, 0.393791, 
          0.596219, 0.442948, 0.657738, 0.473747, 0.645321, 0.406843, 
          0.571844, 0.449143, 0.586385, 0.468664, 0.756921, 0.434403, 
          6.03672e+10, 0.444943, 0.717045, 0.467392, 0.760179, 0.433128, 
          0.698486, 0.466062, 0.737607, 0.490296, 0.858324, 0.440242, 
          0.689794, 0.469565, 0.72938, 0.484848, 0.871604, 0.456638, 
          1.197e+10, 0.464552, 0.746339, 0.481349, 0.79605, 0.453399, 
          0.751623, 0.477986, 0.768419, 0.497774, 1.01931, 0.457759, 
          0.774366, 0.480273, 0.819241, 0.492653, 0.953704, 0.469146, 
          5.85321e+09, 0.475536, 0.75997, 0.488781, 0.821353, 0.465571, 
          0.779084, 0.485163, 0.780446, 0.501848, 1.11999, 0.468536, 
          0.8249, 0.486804, 0.864062, 0.497139, 1.00758, 0.477155, 
          2.02496e+10, 0.482518, 0.76733, 0.493366, 0.840782, 0.473643, 
          0.794812, 0.489953, 0.785496, 0.504273, 1.1778, 0.475854, 
          0.852494, 0.491208, 0.883159, 0.500037, 1.04243, 0.482723, 
          3.79915e+09, 0.487345, 0.771788, 0.496495, 0.856543, 0.479379, 
          0.804951, 0.493379, 0.78775, 0.505805, 1.2103, 0.48115, 
          0.867004, 0.494389, 0.889712, 0.502071, 1.06547, 0.486815, 
          3.05159e+09, 0.490885, 0.774723, 0.498785, 0.869793, 0.483668, 
          0.812175, 0.495955, 0.788787, 0.50686, 1.22865, 0.485151, 
          0.874412, 0.496802, 0.89048, 0.503589, 1.08127, 0.489949, 
          1.73009e+09, 0.493596, 0.776773, 0.500544, 0.881212, 0.487004, 
          0.817725, 0.497966, 0.789255, 0.507663, 1.23911, 0.488266, 
          0.877974, 0.498695, 0.888668, 0.504771, 1.09256, 0.492427, 
          5.2596e+08, 0.495743, 0.778272, 0.501947, 0.891229, 0.489679, 
          0.822229, 0.499583, 0.789448, 0.508315, 1.24507, 0.490757, 
          0.879426, 0.50022, 0.885776, 0.505721, 1.10094, 0.494442, 
          1.38954e+09, 0.49749, 0.77941, 0.503095, 0.900139, 0.491878, 
          0.826027, 0.500916, 0.789505, 0.508861, 1.2484, 0.492797, 
          0.879707, 0.501475, 0.882511, 0.506504, 1.10739, 0.496118, 
          1.24146e+09, 0.498941, 0.780308, 0.504056, 0.90815, 0.493722, 
          0.829322, 0.502036, 0.789497, 0.509325, 1.25014, 0.494509, 
          0.879333, 0.502526, 0.879208, 0.507162, 1.11252, 0.497539, 
          2.95962e+08, 0.50017, 0.78104, 0.504876, 0.91542, 0.495293, 
          0.832239, 0.502992, 0.789459, 0.509721, 1.25093, 0.495974, 
          0.8786, 0.503424, 0.876021, 0.507726, 1.11671, 0.498762, 
          4.76016e+08, 0.501225, 0.781651, 0.505584, 0.922066, 0.49665, 
          0.83486]

# List of values
values81 = [0, 0, 0, 0.0038079, 0, 0.00329444, 0, 0.00466308, 0, 0.00548935, 
          0.00531666, 0.00365665, 0.00687079, 0.0143421, 0.00743335, 
          0.0122296, 0.0154504, 0.0132425, 0.0138693, 0.0339237, 0.0145086, 
          0.0526543, 0.00933496, 0.0342558, 0.0129594, 0.132422, 0.0122224, 
          0.0408022, 0.00970213, 0.0386409, 0.0157585, 0.0480885, 0.0172128, 
          0.0537019, 0.0138776, 0.0705835, 0.0144766, 0.0783181, 0.0116611, 
          0.0886516, 0.0132647, 0.141791, 0.0187115, 0.138393, 0.0152812, 
          0.0864869, 0.0223457, 0.118066, 0.0189175, 0.131012, 0.0196188, 
          0.101424, 0.0230448, 0.0796237, 0.0229748, 0.0435953, 0.0227305, 
          0.0542987, 0.0207592, 0.0669231, 0.0258211, 8.147e+08, 0.0265519, 
          0.0673647, 0.034697, 0.0815788, 0.0263188, 0.0555547, 0.02532, 
          0.0576566, 0.0303994, 0.064478, 0.0314802, 0.0912697, 0.0300954, 
          0.0804847, 0.029645, 0.108076, 0.0301601, 0.0537336, 0.0299825, 
          0.0534431, 0.0305123, 0.099818, 0.0356635, 0.101831, 0.0378643, 
          0.0689776, 0.0348293, 0.0932368, 0.0336577, 0.068081, 0.028474, 
          0.0783506, 0.0298066, 0.103849, 0.0286612, 0.0805318, 0.02838, 
          0.0774274, 0.0305319, 0.0689341, 0.0295718, 0.0811453, 0.0293099, 
          0.0668147, 0.0308467, 0.0764614, 0.0312746, 0.0666161, 0.0298715, 
          0.064524, 0.0296576, 0.0751138, 0.0339467, 0.0491252, 0.0334688, 
          0.0496572, 0.0400888, 0.050583, 0.0388775, 0.0577244, 0.0383793, 
          0.0628227, 0.0434005, 0.0592206, 0.0416581, 0.0554822, 0.041204, 
          0.0561795, 0.0408917, 0.0582363, 0.0414176, 0.0564514, 0.0398076, 
          0.0576216, 0.0396365, 0.0584209, 0.0452138, 0.0444302, 0.0477904, 
          0.0484376, 0.0473321, 0.0484746, 0.0465189, 0.0511251, 0.0416182, 
          0.0451449, 0.0402751, 0.0445979, 0.0395577, 0.0480539, 0.037645, 
          0.0472339, 0.0386521, 0.0462486, 0.0380372, 0.0461055, 0.0378059, 
          0.0475018, 0.0363155, 0.0476331, 0.0358942, 0.0459821, 0.0356417, 
          0.0508513, 0.0354128, 0.0528897, 0.0384609, 0.0484542, 0.0380809, 
          0.0481304, 0.0423741, 0.0457309, 0.0418195, 0.0466959, 0.039934, 
          0.0463623, 0.045038, 0.0461711, 0.0445834, 0.046569, 0.044101, 
          0.0459007, 0.043897, 0.0461097, 0.0451976, 0.0473361, 0.0447901, 
          0.0471334, 0.0447343, 0.0730942, 0.0485355, 0.0721578, 0.051157, 
          0.0688101, 0.0476504, 0.0717114, 0.0470604, 0.069888, 0.0436205, 
          0.0696064, 0.0428891, 0.07575, 0.0425888, 0.0730645, 0.042294, 
          0.0602826, 0.0422798, 0.0644718, 0.0416592, 0.0641348, 0.0414115, 
          0.0623885, 0.0432964, 0.0912136, 0.0429325, 0.0759071, 0.0426414, 
          0.0748221, 0.0402079, 0.0773578, 0.0434108, 8.88536e+07, 0.0432376, 
          0.0758619, 0.0462146, 0.0902192, 0.0426952, 0.0921172]

keys27 = list(range(70, 250))

values27 = [
    0.227339, 0.244925, 0.234975, 0.237858, 0.232244, 0.232288, 0.226161, 0.263779, 0.220507, 
    0.27659, 0.252224, 0.2666, 0.245901, 0.263433, 0.274201, 0.263902, 0.267887, 0.270234, 
    0.262632, 0.26515, 0.26503, 0.260608, 0.273622, 0.262398, 0.267881, 0.25565, 0.262618, 
    0.252799, 0.276062, 0.252156, 0.27182, 0.257591, 0.265908, 0.25274, 0.28791, 0.247653, 
    0.299403, 0.271701, 0.289717, 0.267004, 0.284774, 0.286135, 0.285593, 0.281042, 0.28991, 
    0.276959, 0.284979, 0.280238, 0.280288, 0.287412, 0.281223, 0.28267, 0.276542, 0.277893, 
    0.272226, 0.289268, 0.274598, 0.284697, 0.278007, 0.280386, 0.27355, 0.298005, 0.269359, 
    0.305336, 0.289007, 0.299461, 0.284513, 0.296376, 0.300086, 0.294031, 0.295846, 0.296684, 
    0.291631, 0.292756, 0.295622, 0.288769, 0.300141, 0.289466, 0.296092, 0.285436, 0.29213, 
    0.281874, 0.301162, 0.283353, 0.297341, 0.286742, 0.293466, 0.283052, 0.307848, 0.279402, 
    0.314015, 0.29501, 0.309492, 0.291315, 0.305836, 0.303834, 0.303791, 0.30021, 0.305918, 
    0.296744, 0.302388, 0.299618, 0.298821, 0.30395, 0.299294, 0.300471, 0.295894, 0.296979, 
    0.292561, 0.304604, 0.294513, 0.30121, 0.29664, 0.297954, 0.2933, 0.310134, 0.290101, 
    0.315129, 0.303201, 0.312106, 0.29986, 0.30856, 0.310592, 0.306325, 0.307421, 0.308058, 
    0.304206, 0.305025, 0.307346, 0.301922, 0.31036, 0.302324, 0.307279, 0.299311, 0.30423, 
    0.296421, 0.310596, 0.297668, 0.307575, 0.299878, 0.304648, 0.296985, 0.315186, 0.294137, 
    0.31948, 0.305195, 0.316452, 0.302302, 0.313602, 0.31164, 0.311665, 0.308836, 0.313164, 
    0.30605, 0.310415, 0.308385, 0.307603, 0.311461, 0.307913, 0.308731, 0.305247, 0.305997, 
    0.302595, 0.311524, 0.304104, 0.308837, 0.305502, 0.306256, 0.30286, 0.315596, 0.300299, 
    0.31937, 0.309824, 0.316576, 0.307187, 0.314245, 0.31545, 0.31246, 0.312929, 0.313806
]


# Creating two lists from the new provided data

values13 = [
    0.182267, 0.45188, 0.247563, 0.437802, 0.253598, 0.371781, 0.29371, 0.278954, 0.238051, 0.298714, 
    0.217609, 0.284801, 0.27775, 0.281785, 0.30204, 0.547443, 0.264454, 0.426556, 0.26584, 1.1693e+11, 
    0.264103, 1.48063, 0.283827, 1.21914, 0.279149, 0.949175, 0.267161, 0.821369, 0.297066, 0.649613, 
    0.297463, 0.623076, 0.3294, 0.457614, 0.290766, 0.48682, 0.27798, 0.414101, 0.311646, 0.409566, 
    0.328648, 0.712072, 0.300386, 0.556427, 0.300574, 2.4852e+10, 0.298604, 2.27581, 0.31278, 1.79039, 
    0.307847, 1.48401, 0.296254, 1.32664, 0.316556, 0.969149, 0.316694, 0.963282, 0.340829, 0.687537, 
    0.311263, 0.73282, 0.302456, 0.573036, 0.326026, 0.570611, 0.338824, 0.94902, 0.316605, 0.733664, 
    0.316387, 1.51836e+10, 0.314837, 3.32004, 0.325625, 2.55517, 0.321338, 2.15784, 0.311395, 1.95355, 
    0.326651, 1.3704, 0.326647, 1.38392, 0.345995, 0.972785, 0.322096, 1.04079, 0.315377, 0.770583, 
    0.333569, 0.767716, 0.343798, 1.24089, 0.32562, 0.951112, 0.325292, 2.33865e+09, 0.32405, 4.52993, 
    0.332698, 3.45042, 0.328967, 2.94163, 0.320534, 2.68283, 0.332748, 1.83728, 0.332643, 1.87212, 
    0.348831, 1.30619, 0.328803, 1.40164, 0.32335, 1.00262, 0.338165, 0.997225, 0.346668, 1.57805, 
    0.331337, 1.20271, 0.330995, 1.07242e+09, 0.329963, 5.87564, 0.337162, 4.45166, 0.333835, 3.81856, 
    0.326616, 3.49993, 0.336819, 2.35922, 0.336653, 2.41785, 0.35054, 1.68086, 0.333376, 1.80751, 
    0.328773, 1.26407, 0.341259, 1.25473, 0.348519, 1.954, 0.335281, 1.4836, 0.334961, 7.48279e+08, 
    0.334078, 7.34003, 0.340238, 5.54461, 0.337216, 4.77748, 0.33095, 4.39464, 0.339727, 2.92911, 
    0.339536, 3.01404, 0.351627, 2.09173, 0.336697, 2.25278, 0.332705, 1.55104, 0.343491, 1.53677, 
    0.349814, 2.36416, 0.338165, 1.79022, 0.337878, 9.24305e+08, 0.337109, 8.91142, 0.342491, 6.71955, 
    0.339715, 5.81034, 0.334197, 5.3595, 0.341909, 3.54195, 0.341713, 3.65558, 0.352366, 2.5351, 
    0.339212, 2.73341, 0.335684, 1.86068, 0.345183, 1.84073, 0.350777, 2.80519, 0.340368, 2.11993, 
    0.340113, 5.28107e+08, 0.339437, 10.5811, 0.344216, 7.96936, 0.341648, 6.91105, 0.336725, 6.3888, 
    0.343609, 4.19399, 0.343419, 4.33859, 0.352916, 3.00816, 0.341174, 3.24634, 0.338011, 2.19088, 
    0.346511, 2.16467, 0.351526, 3.27454, 0.342109, 2.47072, 0.34188, 3.60617e+08, 0.341284, 12.3422
]


values15 = [
    0.35194, 0.980645, 0.368702, 0.457862, 0.405757, 0.18502, 0.416818, 0.254413, 
    0.471484, 0.232197, 0.404116, 0.44689, 0.444838, 0.40587, 0.46205, 0.395664, 
    0.432028, 0.417603, 0.418883, 0.450551, 0.422917, 0.42383, 0.409681, 0.471195, 
    0.391182, -10, 0.500598, 0.477909, 0.481723, 0.480503, 0.477236, 0.488702, 
    0.484399, 0.4644, 0.501051, 0.454107, 0.486285, 0.466136, 0.519943, 0.440829, 
    0.521708, 0.521763, 0.516195, 0.513266, 0.516525, 0.504399, 0.501175, 0.510437, 
    0.496517, 0.533203, 0.494407, 0.509221, 0.493865, 0.534776, 0.480871, 0.540633, 
    0.544602, 0.530983, 0.530864, 0.529671, 0.532129, 0.523483, 0.534393, 0.512732, 
    0.544743, 0.510061, 0.532695, 0.5168, 0.553223, 0.499222, 0.557133, 0.550804, 
    0.54824, 0.554903, 0.546734, 0.539239, 0.535316, 0.541998, 0.531403, 0.563125, 
    0.530141, 0.539771, 0.528962, 0.557039, 0.518993, 0.560355, 0.562309, 0.552585, 
    0.551967, 0.551112, 0.553155, 0.544322, 0.554118, 0.537677, 0.561032, 0.535765, 
    0.551566, 0.539166, 0.566311, 0.526502, 0.569592, 0.563833, 0.562026, 0.588907, 
    0.560588, 0.554996, 0.551622, 0.556584, 0.548411, 0.578435, 0.547338, 0.553974, 
    0.545917, 0.56707, 0.537884, 0.569437, 0.570354, 0.56333, 0.562131, 0.562081, 
    0.563025, 0.555912, 0.563563, 0.551188, 0.568482, 0.5496, 0.560793, 0.551297, 
    0.572392, 0.54154, 0.575085, 0.57054, 0.568964, 0.687701, 0.56779, 0.563389, 
    0.560451, 0.564431, 0.557808, 0.588655, 0.556808, 0.561724, 0.555383, 0.572318, 
    0.548679, 0.574451, 0.574589, 0.5693, 0.567782, 0.56828, 0.568477, 0.562808, 
    0.568841, 0.559193, 0.572537, 0.557816, 0.566088, 0.558626, 0.575696, 0.550728, 
    0.57797, 0.574375, 0.572938, 19.8951, 0.571987, 0.568379, 0.565787, 0.569128, 
    0.563569, 0.597271, 0.56263, 0.56647, 0.56128, 0.57539, 0.555538, 0.577199, 
    0.577084, 0.572926, 0.571282, 0.572087, 0.571848, 0.567224, 0.572124, 0.564319, 
    0.575027, 0.5631, 0.56948, 0.563425, 0.577703, 0.556804, 0.579672, 0.576756, 
    0.575436, 0.681121, 0.574652, 0.571602, 0.569292, 0.572175, 0.56739, 0.606038, 
    0.56651, 0.56963, 0.565256, 0.577347, 0.560239, 0.579209, 0.578678, 0.575294, 
    0.573626, 0.574592, 0.574103, 0.570235, 0.574329, 0.567818, 0.576688, 0.566724, 
    0.571825, 0.56677, 0.579021, 0.561078, 0.58076, 0.578334, 0.577118, 0.602729, 
    0.576459, 0.573819, 0.57174, 0.574278, 0.570079, 0.616305
]


values9cb = [0.759465, 0.673526, 0.698907, 0.725063, 0.689442, 0.683398, 0.6742, 1.081, 0.773385, 1.12567, 0.750469, 0.901875, 0.720933, 0.939106, 0.772695, 1.1724, 0.844527, 1.14351, 0.922152, 1.11277, 0.877891, 1.02605, 0.872149, 1.11161, 0.831069, 1.66619, 0.918618, 1.61046, 0.903125, 4.1157, 0.87785, 11.929, 0.909309, 1.66232, 0.95796, 3.62603, 1.00711, 2.61005, 0.985871, 2.22752, 0.969298, 2.01747, 0.938626, 2.7838, 1.01471, 1.43323, 1.00714, 1.48833, 0.997458, 1.36229, 1.00979, 1.26584, 1.02902, 2.01801, 1.06876, 2.17607, 1.05852, 3.48503, 1.04487, 2.51452, 1.01996, 93.2535, 1.09427, 1.92007, 1.10014, 1.92863, 1.09729, 1.62514, 1.10677, 1.57519, 1.0737, 1.53778, 1.11828, 2.09331, 1.11421, 2.08374, 1.10823, 2.74248, 1.09378, 3.48312, 1.17501, 2.44209, 1.17798, 3.40008, 1.14823, 2.05916, 1.17039, 2.30063, 1.11621, 8.04528, 1.1639, 1.82358, 1.16949, 1.54053, 1.17196, 1.62678, 1.16532, 2.15698, 1.22509, 2.27688, 1.20878, 3.26798, 1.17227, 2.53635, 1.1928, 3.47537, 1.15544, 1.64974, 1.21024, 1.60189, 1.2292, 1.52019, 1.2305, 1.46984, 1.20607, 1.78232, 1.23846, 1.93325, 1.22545, 5.34731, 1.19666, 2.64478, 1.2086, 2.61141, 1.19178, 1.84446, 1.26257, 1.73404, 1.26699, 1.64853, 1.25697, 1.47169, 1.22269, 1.66167, 1.25075, 1.95884, 1.2451, 1.85258, 1.22332, 2.03425, 1.22938, 2.03167, 1.22678, 2.26303, 1.31258, 1.97554, 1.27754, 1.93292, 1.26861, 1.54143, 1.23877, 1.66174, 1.26873, 2.04292, 1.26748, 1.66145, 1.25075, 1.76238, 1.25341, 1.74588, 1.26198, 2.81053, 1.33172, 2.18558, 1.2871, 2.4898, 1.28247, 1.66811, 1.2583, 1.76259, 1.28927, 1.64324, 1.29095, 1.62568, 1.27886, 1.64795, 1.27902, 1.63102, 1.29842, 2.92431, 1.33694, 2.21363, 1.30204, 3.38058, 1.30009, 1.85157, 1.27997, 2.05509, 1.31098, 1.65163, 1.31512, 1.67823, 1.30862, 1.62779, 1.30586, 1.61368, 1.33368, 2.49709, 1.34601, 2.1672, 1.32041, 3.2746, 1.32017, 2.07333, 1.30332, 8.70521, 1.33423, 1.73275, 1.34074, 1.81763, 1.34124, 1.67156, 1.33459, 1.66832, 1.35923, 2.11024, 1.36003, 2.10418, 1.3408, 2.64292, 1.34197, 2.25659, 1.32884, 3.0017, 1.36059, 1.86788, 1.3694, 2.07742, 1.37295, 1.76597]


# Plot settings

f = plt.figure()
f.set_figwidth(5)
f.set_figheight(4)

_, ax = plt.subplots()

linew = 1.5
cvalr, cvalg, cvalb = 1, 0.8, 1
mfcvalr, mfcvalg, mfcvalb = 0.7, 0.5, 0.7

start1, start2, start3 = 0, 0, 90

# Plot
# plt1 ,= plt.semilogy(x[start1:], y[start1:], '-o', linewidth=linew, color=[cvalr, 0.0, 0.0], markerfacecolor=[mfcvalr, 0.0, 0.0])
# plt2 ,= plt.semilogy(x[start2:], y2[start2:], '-o', linewidth=linew, color=[0.0, 0.0, cvalb], markerfacecolor=[0.0, 0.0, mfcvalb])
# plt3 ,= plt.semilogy(x[start3:], y3[start3:], '-o', linewidth=linew, color=[0.0, cvalg, 0.0], markerfacecolor=[0.0, mfcvalg, 0.0])

plt1 ,= plt.semilogy(keys[start1:], values9[start1:], '-o', linewidth=linew, color=[cvalr, 0.0, 0.0], markerfacecolor=[mfcvalr, 0.0, 0.0])
plt2 ,= plt.semilogy(keys[start1:], values13[start1:], '-o', linewidth=linew, color=[0.0, cvalg, cvalb], markerfacecolor=[0.0, mfcvalg, mfcvalb])
plt3 ,= plt.semilogy(keys[start1:], values15[start1:], '-o', linewidth=linew, color=[cvalr, 0.0, cvalb], markerfacecolor=[mfcvalr, 0.0, mfcvalb])
plt4 ,= plt.semilogy(keys27[start2:], values27[start2:], '-o', linewidth=linew, color=[0.0, 0.0, cvalb], markerfacecolor=[0.0, 0.0, mfcvalb])
plt5 ,= plt.semilogy(keys[start3:], values81[start3:], '-o', linewidth=linew, color=[0.0, cvalg, 0.0], markerfacecolor=[0.0, mfcvalg, 0.0])

extra = Rectangle((0, 0), 1, 1, fc="w", fill=False, edgecolor='none', linewidth=0)

legend_handle = [extra, extra, extra, plt1, extra, plt2, extra, plt3, extra, plt4, extra, plt5]

label_col_1 = [r"Pattern \textbackslash\ Size", r"Sponge"]
label_j_1 = [r"$s = 9$"]
label_j_2 = [r"$s = 13$"]
label_j_3 = [r"$s = 15$"]
label_j_4 = [r"$s = 27$"]
label_j_5 = [r"$s = 81$"]
label_empty = [""]

# Labels and grid
plt.xlabel(r'\textsc{fem} mesh size')
plt.ylabel(r'Relative error $\|\nabla(u_h - \overline{u}_h)\|_{L^2(\Omega)} / \|\nabla u_h\|_{L^2(\Omega)}$')
# plt.grid(True, which='both')
plt.grid(axis='both', which='major', ls='-')
plt.grid(axis='both', which='minor', ls='dotted', alpha=1)
plt.gca().yaxis.set_minor_locator(LogLocator(numticks=15,subs=np.arange(2,10)))


# Legend
# plt.legend([r'$9$', r'$27$', r'Sponge: $81$', r'$9$', r'$27$', r'Checkerboard: $81$'], loc='upper center', ncol=3)

#organize labels for table construction
legend_labels = numpy.concatenate([label_col_1, label_j_1, label_empty * 1, label_j_2, label_empty * 1, label_j_3, label_empty * 1, label_j_4, label_empty * 1, label_j_5, label_empty * 1])

#Create legend
plt.legend(legend_handle, legend_labels, 
          # loc = 'upper center', 
          bbox_to_anchor=(0, 1, 1, 0), loc="lower center",
          # bbox_to_anchor=(0.5, 1.2), loc='upper center',
          ncol = 6, shadow = False, handletextpad = -2,
          columnspacing=1, labelspacing=0.8)

# Ticks
ticks9 = [27, 45, 63, 81, 99, 117, 135, 153, 171, 189, 207, 225, 243]
ticks13 = [39, 65, 91, 117, 143, 169, 195, 221, 247]
ticks15 = [183]

ticks = sorted(set(ticks9 + ticks13 + ticks15))

plt.xticks(ticks, rotation=0)

# Iterate over tick labels and color them one by one
for i, tick in enumerate(ax.get_xticklabels()):
    if ticks[i] in ticks9:
        tick.set_color([cvalr, 0.0, 0.0]) 
    elif ticks[i] in ticks13:
        tick.set_color([0.0, cvalg, cvalb])  
        tick.set_y(-0.05)    
    else:
        tick.set_color([cvalr, 0.0, cvalb])  
        tick.set_y(-0.1)    

# Show or save plot
plt.tight_layout()
plt.show()

# plt.savefig("relative_energy_errors_vs_femsize_zoom.pgf") # save as PGF file which can be used in your document via `\input`
